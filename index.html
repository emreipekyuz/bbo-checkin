<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Bir Bulut Olsam â€” Etkinlik Check-in</title>
  <meta name="theme-color" content="#5B8DEF" />
  <style>
    :root{
      --bg:#F4F7FF; --card:#FFFFFF; --primary:#5B8DEF; --primary-700:#355CD6; --accent:#8EE1F7;
      --ok:#0f766e; --err:#b91c1c; --text:#111827; --muted:#64748b; --shadow:0 10px 30px rgba(43,78,255,.12);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:radial-gradient(1200px 600px at 80% -10%, #dbeafe 0%, transparent 60%),var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial}
    .wrap{max-width:720px;margin:min(6vh,48px) auto;padding:16px}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:clamp(18px,2.8vw,28px);overflow:hidden;border:1px solid #e5e7eb}
    .brand{display:flex;align-items:center;gap:12px;margin-bottom:8px}
    .logo{width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,var(--primary),var(--accent));box-shadow:0 6px 18px rgba(91,141,239,.35);position:relative}
    .logo:before,.logo:after{content:"";position:absolute;background:#fff;border-radius:999px;opacity:.9}
    .logo:before{width:18px;height:18px;left:8px;top:14px}
    .logo:after{width:26px;height:26px;left:18px;top:8px}
    h1{font-size:clamp(1.2rem,1.1rem + 1.2vw,1.8rem);margin:6px 0 2px}
    .sub{color:var(--muted);font-size:.95rem;margin:0 0 14px}
    label{display:block;font-weight:600;margin:14px 0 8px}
    select,input[type="text"],input[type="tel"]{width:100%;padding:14px 12px;border:1px solid #d7dce7;border-radius:12px;font-size:1rem;outline:none;background:#fff}
    select:focus,input:focus{border-color:var(--primary);box-shadow:0 0 0 3px rgba(91,141,239,.18)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media (max-width:640px){.grid{grid-template-columns:1fr}}

    .kvkk-wrap{margin-top:12px;border:1px solid #e2e8f0;border-radius:14px;overflow:hidden;background:#fafcff}
    .kvkk-head{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:12px 14px;cursor:pointer;background:linear-gradient(180deg,#f0f7ff,#ecf3ff);border-bottom:1px solid #e2e8f0}
    .kvkk-head h3{margin:0;font-size:1rem}
    .kvkk-badge{font-size:.8rem;color:#334155;background:#e2e8f0;padding:4px 8px;border-radius:999px}
    .kvkk-body{max-height:0;overflow:auto;transition:max-height .35s ease;background:#fff}
    .kvkk-body.open{max-height:50vh;border-top:1px dashed #e2e8f0}
    .kvkk-content{padding:14px;line-height:1.5;white-space:pre-wrap;font-size:.95rem;color:#334155}
    .kvkk-note{font-size:.9rem;color:#475569;margin-top:8px;display:flex;align-items:center;gap:8px}
    .kvkk-controls{display:flex;align-items:center;gap:10px;margin-top:12px;padding:0 14px 14px}
    .checkbox{width:20px;height:20px}

    .btn{width:100%;padding:14px;border:0;border-radius:12px;font-weight:700;font-size:1rem;color:#fff;background:linear-gradient(135deg,var(--primary),var(--primary-700));cursor:pointer;box-shadow:0 10px 24px rgba(53,92,214,.25)}
    .btn:disabled{opacity:.65;cursor:not-allowed;box-shadow:none}

    .status{margin-top:12px;font-size:.95rem}
    .ok{color:var(--ok)} .err{color:var(--err)}

    @media (hover:none){select,input,button,label{min-height:48px}}
    .footer{text-align:center;color:#64748b;font-size:.9rem;margin-top:14px}
    .footer a{color:#355CD6;text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <strong>Bir Bulut Olsam DerneÄŸi</strong>
          <div class="sub">Etkinlik Check-in</div>
        </div>
      </div>

      <label for="event">Etkinlik SeÃ§</label>
      <select id="event">
        <option value="">YÃ¼kleniyorâ€¦</option>
      </select>

      <div class="grid">
        <div>
          <label for="name">Ad Soyad</label>
          <input id="name" type="text" placeholder="Ad Soyad" autocomplete="name" />
        </div>
        <div>
          <label for="phone">Telefon</label>
          <input id="phone" type="tel" placeholder="05xx xxx xx xx" autocomplete="tel" inputmode="tel" />
        </div>
      </div>

      <!-- KVKK -->
      <div class="kvkk-wrap" id="kvkkWrap">
        <div class="kvkk-head" id="kvkkToggle" role="button" aria-expanded="false">
          <h3>KÄ°ÅÄ°SEL VERÄ°LERÄ°N KORUNMASI KANUNU KAPSAMINDA AYDINLATMA METNÄ°</h3>
          <span class="kvkk-badge">Oku â†’ KaydÄ±r</span>
        </div>
        <div class="kvkk-body" id="kvkkBody" aria-hidden="true">
          <div class="kvkk-content" id="kvkkContent">
KÄ°ÅÄ°SEL VERÄ°LERÄ°N KORUNMASI KANUNU KAPSAMINDA AYDINLATMA METNÄ°
Bir Bulut Olsam DerneÄŸi ("Dernek") olarak, veri sorumlusu sÄ±fatÄ±yla, dÃ¼zenlediÄŸimiz etkinliklere katÄ±lÄ±mÄ±nÄ±z sÄ±rasÄ±nda sizlerden elde edilen kiÅŸisel verilerinize bÃ¼yÃ¼k Ã¶nem veriyoruz. KiÅŸisel verilerinizin 6698 sayÄ±lÄ± KiÅŸisel Verilerin KorunmasÄ± Kanunu ("KVKK") uyarÄ±nca iÅŸlenmesi ve korunmasÄ± sÃ¼reÃ§lerinde ÅŸeffaflÄ±ÄŸÄ± saÄŸlamak amacÄ±yla bu aydÄ±nlatma metnini bilgilerinize sunuyoruz.

1. Veri Sorumlusunun KimliÄŸi
KVKK uyarÄ±nca kiÅŸisel verileriniz, veri sorumlusu olarak aÅŸaÄŸÄ±da bilgileri sunulan Bir Bulut Olsam DerneÄŸi tarafÄ±ndan iÅŸlenecektir.
DerneÄŸin AdÄ±: Bir Bulut Olsam DerneÄŸi
Adres: Karaman Mahallesi, Tuna Caddesi, Fulya Sokak, No:1, NilÃ¼fer/Bursa
Telefon: 0555 156 07 33
E-posta: birbulutolsamdernegi@gmail.com
Web Sitesi: BulunmamaktadÄ±r.

2. KiÅŸisel Verilerin Ä°ÅŸlenme AmaÃ§larÄ±
Etkinliklerimize katÄ±lÄ±mÄ±nÄ±zla baÄŸlantÄ±lÄ± olarak toplanan kiÅŸisel verileriniz, aÅŸaÄŸÄ±da belirtilen amaÃ§larla sÄ±nÄ±rlÄ± olarak iÅŸlenmektedir:
â€¢ Etkinlik YÃ¶netimi: Etkinlik kayÄ±tlarÄ±nÄ±n oluÅŸturulmasÄ±, katÄ±lÄ±mcÄ± listelerinin hazÄ±rlanmasÄ±, yaka kartlarÄ±nÄ±n basÄ±lmasÄ± ve etkinliÄŸin sorunsuz bir ÅŸekilde yÃ¼rÃ¼tÃ¼lmesi.
â€¢ Ä°letiÅŸim: Etkinlik Ã¶ncesi bilgilendirme, hatÄ±rlatma, yer ve zaman deÄŸiÅŸikliÄŸi gibi konularda sizinle iletiÅŸime geÃ§ilmesi; etkinlik sonrasÄ± teÅŸekkÃ¼r ve deÄŸerlendirme anketlerinin gÃ¶nderilmesi.
â€¢ TanÄ±tÄ±m ve Kamuoyu Bilgilendirmesi: Etkinlik sÄ±rasÄ±nda Ã§ekilen fotoÄŸraf ve video kayÄ±tlarÄ±nÄ±n, DerneÄŸin faaliyetlerini tanÄ±tmak, kamuoyunu bilgilendirmek ve arÅŸiv oluÅŸturmak amacÄ±yla DerneÄŸin sosyal medya hesaplarÄ± (Instagram, Facebook, Twitter, vb.), bÃ¼ltenler ve diÄŸer basÄ±lÄ±/dijital yayÄ±n organlarÄ±nda paylaÅŸÄ±lmasÄ±.
â€¢ Yasal YÃ¼kÃ¼mlÃ¼lÃ¼kler: Dernekler mevzuatÄ± ve diÄŸer ilgili kanunlar uyarÄ±nca resmi kurumlara yapÄ±lmasÄ± gereken zorunlu bildirimlerin yerine getirilmesi.
â€¢ Raporlama ve Analiz: Gelecekteki etkinlikleri iyileÅŸtirmek amacÄ±yla katÄ±lÄ±mcÄ± profili hakkÄ±nda isimsizleÅŸtirilmiÅŸ (anonim) istatistiksel veriler oluÅŸturulmasÄ±.

3. Ä°ÅŸlenen KiÅŸisel Veri Kategorileri ve Toplama YÃ¶ntemleri
KiÅŸisel verileriniz; etkinlik kayÄ±t formlarÄ±, e-posta, telefon gÃ¶rÃ¼ÅŸmeleri ve etkinlik sÄ±rasÄ±nda gerÃ§ekleÅŸtirilen fotoÄŸraf/video Ã§ekimleri gibi otomatik/otomatik olmayan yÃ¶ntemlerle toplanmaktadÄ±r. BaÅŸlÄ±ca kiÅŸisel verileriniz:
â€¢ Kimlik Bilgileri: Ad, SoyadÄ±
â€¢ Ä°letiÅŸim Bilgileri: E-posta Adresi, Telefon NumarasÄ±
â€¢ GÃ¶rsel ve Ä°ÅŸitsel Veriler: Etkinlik sÄ±rasÄ±nda Ã§ekilen fotoÄŸraf ve video kayÄ±tlarÄ±

4. KiÅŸisel Verilerin AktarÄ±labileceÄŸi Taraflar ve AktarÄ±m AmaÃ§larÄ±
KiÅŸisel verileriniz, KVKKâ€™nÄ±n 8. ve 9. maddelerine uygun olarak; tedarikÃ§iler, iÅŸ ortaklarÄ±, yetkili kamu kurum/kuruluÅŸlarÄ± ve tanÄ±tÄ±m faaliyetleri kapsamÄ±nda kamuoyu ile paylaÅŸÄ±labilir.

5. KiÅŸisel Veri ToplamanÄ±n Hukuki Sebebi
KiÅŸisel verileriniz KVKK md.5 kapsamÄ±ndaki hukuki sebeplere dayanÄ±larak iÅŸlenmektedir: sÃ¶zleÅŸmenin kurulmasÄ±/ifasÄ±, hukuki yÃ¼kÃ¼mlÃ¼lÃ¼k, meÅŸru menfaat. FotoÄŸraf-video gibi veriler ve tanÄ±tÄ±m amaÃ§lÄ± paylaÅŸÄ±mlar iÃ§in aÃ§Ä±k rÄ±za esastÄ±r. Etkinlik alanÄ±na girmeniz ve/veya formu doldurmanÄ±z bu metin kapsamÄ±nda aydÄ±nlatÄ±lmÄ±ÅŸ rÄ±zanÄ±zÄ±n bulunduÄŸu anlamÄ±na gelebilir.

6. Ä°lgili KiÅŸi Olarak HaklarÄ±nÄ±z (KVKK md.11)
â€¢ Ä°ÅŸlenip iÅŸlenmediÄŸini Ã¶ÄŸrenme, â€¢ bilgi talep etme, â€¢ amacÄ±na uygun kullanÄ±mÄ± Ã¶ÄŸrenme, â€¢ aktarÄ±lan Ã¼Ã§Ã¼ncÃ¼ kiÅŸileri bilme, â€¢ dÃ¼zeltme, â€¢ silme/yok etme talebi, â€¢ bilgilendirme, â€¢ otomatik iÅŸleme itiraz, â€¢ zarar halinde tazmin talebi haklarÄ±na sahipsiniz.
BaÅŸvurularÄ±nÄ±zÄ± kimlik teyidi ile yazÄ±lÄ± olarak veya kayÄ±tlÄ± kanallardan birbulutolsamdernegi@gmail.com adresine iletebilirsiniz. BaÅŸvurular 30 gÃ¼n iÃ§inde sonuÃ§landÄ±rÄ±lÄ±r.

Bu aydÄ±nlatma metni mevzuat ve koÅŸullara gÃ¶re gÃ¼ncellenebilir.
Bir Bulut Olsam DerneÄŸi
          </div>
          <div class="kvkk-controls">
            <input id="kvkk" class="checkbox" type="checkbox" disabled />
            <label for="kvkk" style="font-weight:600;margin:0;">KVKK metnini okudum, kiÅŸisel verilerimin iÅŸlenmesine onay veriyorum.</label>
          </div>
          <div class="kvkk-note" id="kvkkNote">ğŸ”’ Onay kutusu, metni en alta kadar kaydÄ±rÄ±nca aktifleÅŸir.</div>
        </div>
      </div>

      <button class="btn" id="submitBtn" disabled>Check-in Yap</button>
      <div id="status" class="status"></div>
    </div>

    <div class="footer">Â© Bir Bulut Olsam DerneÄŸi Â· <a href="#" id="openKvkk">KVKK Metnini AÃ§</a></div>
  </div>

  <script>
    // Apps Script EXEC URL ( /macros/ ile baÅŸlayan )
    const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbymxMJJvySLXFzYqTBmZrhzxHXDDlJb8Vu178TD-3JafcO_ytNSXTJwMZ7EaIdNnr1Y/exec";

    // Elemanlar
    const elEvent = document.getElementById('event');
    const elName  = document.getElementById('name');
    const elPhone = document.getElementById('phone');
    const elKvkk  = document.getElementById('kvkk');
    const elStatus= document.getElementById('status');
    const btn     = document.getElementById('submitBtn');

    const kvkkToggle  = document.getElementById('kvkkToggle');
    const kvkkBody    = document.getElementById('kvkkBody');
    const kvkkContent = document.getElementById('kvkkContent');
    const kvkkNote    = document.getElementById('kvkkNote');
    const openKvkk    = document.getElementById('openKvkk');

    function setStatus(msg, ok=false){
      elStatus.className = 'status ' + (ok ? 'ok' : 'err');
      elStatus.textContent = msg || '';
    }
    function validatePhone(p){
      const digits = (p||'').replace(/\D/g,'');
      return digits.length >= 10;
    }

    // KVKK aÃ§/kapa
    function toggleKvkk(open){
      kvkkBody.classList.toggle('open', open);
      kvkkBody.setAttribute('aria-hidden', open ? 'false':'true');
      kvkkToggle.setAttribute('aria-expanded', open ? 'true':'false');
    }
    kvkkToggle.addEventListener('click', ()=> toggleKvkk(!kvkkBody.classList.contains('open')));
    openKvkk.addEventListener('click', (e)=>{ e.preventDefault(); toggleKvkk(true); kvkkBody.scrollTop = 0; });

    // Metni sona kadar kaydÄ±rÄ±nca onay aktifleÅŸsin
    kvkkBody.addEventListener('scroll', ()=>{
      const atBottom = kvkkBody.scrollTop + kvkkBody.clientHeight >= kvkkContent.offsetHeight - 8;
      if (atBottom){
        elKvkk.disabled = false;
        kvkkNote.textContent = "âœ… Onay kutusunu iÅŸaretleyebilirsiniz.";
      }
    });

    // Buton durumunu alanlara gÃ¶re ayarla
    function updateButton(){
      const ok = elEvent.value && elName.value.trim() && validatePhone(elPhone.value) && elKvkk.checked;
      btn.disabled = !ok;
    }
    elEvent?.addEventListener('change', updateButton);
    elName.addEventListener('input', updateButton);
    elPhone.addEventListener('input', updateButton);
    elKvkk.addEventListener('change', updateButton);

    // Etkinlikleri yÃ¼kle: Ã¶nce fetch; CORS hatasÄ±nda JSONP'ye dÃ¼ÅŸ
    async function loadEventsFetch(){
      const res = await fetch(WEBAPP_URL + "?action=events", { method:'GET' });
      return res.json();
    }
    function loadEventsJSONP(){
      return new Promise((resolve,reject)=>{
        const cb = 'bboCb_' + Math.random().toString(36).slice(2);
        window[cb] = (data)=>{ resolve(data); delete window[cb]; s.remove(); };
        const s = document.createElement('script');
        s.src = WEBAPP_URL + '?action=events&callback=' + cb;
        s.onerror = ()=>{ reject(new Error('JSONP yÃ¼klenemedi')); s.remove(); delete window[cb]; };
        document.body.appendChild(s);
      });
    }
    async function loadEvents(){
      try{
        let data;
        try{ data = await loadEventsFetch(); }
        catch(_){ data = await loadEventsJSONP(); }

        if (!data.ok) throw new Error(data.error || 'Bilinmeyen hata');
        elEvent.innerHTML = '<option value="">Bir etkinlik seÃ§inâ€¦</option>';
        (data.events||[]).forEach(ev=>{
          const opt = document.createElement('option');
          opt.value = ev.eventCode;
          opt.textContent = `${ev.eventName} (${ev.eventCode})`;
          elEvent.appendChild(opt);
        });
        if ((data.events||[]).length===0) setStatus('Aktif etkinlik bulunamadÄ±.', false);
        else setStatus('');
        updateButton();
      }catch(err){
        setStatus('Etkinlik listesi yÃ¼klenemedi: ' + err.message, false);
      }
    }

    // PRE-FLIGHT tetiklemeyen POST (URL-encoded, simple request)
    async function submitCheckin(){
      setStatus('');
      const eventCode = elEvent.value;
      const name = elName.value.trim();
      const phone = elPhone.value.trim();
      const kvkk = elKvkk.checked;

      if (!eventCode) return setStatus('LÃ¼tfen bir etkinlik seÃ§in.', false);
      if (!name) return setStatus('LÃ¼tfen ad soyad girin.', false);
      if (!validatePhone(phone)) return setStatus('Telefon formatÄ± hatalÄ± gÃ¶rÃ¼nÃ¼yor.', false);
      if (!kvkk) return setStatus('KVKK onayÄ± gereklidir.', false);

      btn.disabled = true;
      try{
        const body = new URLSearchParams({ eventCode, name, phone });
        const res = await fetch(WEBAPP_URL, {
          method:'POST',
          headers:{ 'Content-Type':'application/x-www-form-urlencoded;charset=UTF-8' }, // simple request
          body
        });
        if (!res.ok) throw new Error('Sunucudan beklenmedik yanÄ±t');

        setStatus('Check-in alÄ±ndÄ±. Ä°yi etkinlikler! â˜ï¸', true);
        elName.value=''; elPhone.value=''; elKvkk.checked=false; elKvkk.disabled=true;
        document.getElementById('kvkkNote').textContent = 'ğŸ”’ Onay kutusu, metni en alta kadar kaydÄ±rÄ±nca aktifleÅŸir.';
        updateButton();
      }catch(err){
        setStatus('GÃ¶nderim hatasÄ±: ' + err.message, false);
      }finally{
        btn.disabled = false;
      }
    }
    document.getElementById('submitBtn').addEventListener('click', submitCheckin);

    // BaÅŸlat
    loadEvents();
  </script>
</body>
</html>
